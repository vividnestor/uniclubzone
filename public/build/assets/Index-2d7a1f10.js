import{d as V,an as z,aj as E,o as c,e as h,w as a,D as r,f as e,aN as x,G as m,t,b as s,a4 as L,a as C,R as D,P as K,q as $,c9 as Y,v as w,ca as A,g as M,al as ee,ae as q,Q as ae,F as te,bZ as le,aK as oe,aH as ne,aI as se}from"./vendor-d45124f2.js";import{j as Q,_ as re,a as I,h as j,t as Z,d as ue,l as ie,r as pe,n as ce,o as P,g as de,i as B,L as R}from"./index-1b5bb668.js";import{_ as fe}from"./PageHeader.vue_vue_type_script_setup_true_lang-10c52b00.js";import{_ as me}from"./PageContent.vue_vue_type_script_setup_true_lang-cfff65eb.js";import{_ as N}from"./Tag.vue_vue_type_script_setup_true_lang-26dcd870.js";import{_ as ge}from"./FiltersDropdown.vue_vue_type_script_setup_true_lang-e80272f9.js";import{u as be}from"./useListingFilters-73633904.js";import"./pickBy-f54d659e.js";import"./_baseIteratee-3ccc71d1.js";const ve=V({__name:"EditTranslationModal",props:{languageLine:{},locales:{}},setup(O){const g=O,u=z({text:g.languageLine.text}),i=E(),v=l=>{u.post(route("craftable-pro.translations.update",[g.languageLine.id]),{onFinish:()=>{l(),i.success(Z("craftable-pro","Translation was successfully updated"))}})};return(l,p)=>(c(),h(e(j),null,{trigger:a(({setIsOpen:d})=>[r(e(Q),{as:"button",onClick:()=>d(!0),variant:"ghost",color:"gray",icon:e(x)},null,8,["onClick","icon"])]),title:a(()=>[m(t(l.$t("craftable-pro","Edit translation")),1)]),content:a(()=>[s("form",{class:"space-y-6",onSubmit:L(v,["prevent"])},[(c(!0),C(D,null,K(l.locales,d=>(c(),C("div",null,[r(e(re),{modelValue:e(u).text[d],"onUpdate:modelValue":o=>e(u).text[d]=o,label:d,name:"text",type:"text"},null,8,["modelValue","onUpdate:modelValue","label"])]))),256))],32)]),buttons:a(({setIsOpen:d})=>[r(e(I),{loading:e(u).processing,onClick:L(o=>v(d),["prevent"])},{default:a(()=>[m(t(l.$t("craftable-pro","Save")),1)]),_:2},1032,["loading","onClick"]),r(e(I),{color:"gray",variant:"outline",onClick:L(()=>d(),["prevent"])},{default:a(()=>[m(t(l.$t("craftable-pro","Cancel")),1)]),_:2},1032,["onClick"])]),_:1}))}}),_e={class:"space-y-6"},ye=V({__name:"ExportModal",props:{locales:{},open:{type:Boolean}},emits:["toggleOpen"],setup(O,{emit:g}){const u=z({exportLanguages:[]}),i=p=>{window.location.href="/admin/translations/export?exportLanguages[]="+u.exportLanguages.join("&exportLanguages[]="),p()},v=g,l=()=>{v("toggleOpen")};return(p,d)=>(c(),h(e(j),{open:p.open,onToggleOpen:l,"external-open":!0},{title:a(()=>[m(t(p.$t("craftable-pro","Export translations")),1)]),content:a(()=>[s("div",_e,[r(e(N),{modelValue:e(u).exportLanguages,"onUpdate:modelValue":d[0]||(d[0]=o=>e(u).exportLanguages=o),options:p.locales,label:p.$t("craftable-pro","Languages"),mode:"tags",name:""},null,8,["modelValue","options","label"])])]),buttons:a(({setIsOpen:o})=>[r(e(I),{loading:e(u).processing,onClick:L(_=>i(o),["prevent"])},{default:a(()=>[m(t(p.$t("craftable-pro","Export")),1)]),_:2},1032,["loading","onClick"]),r(e(I),{color:"gray",variant:"outline",onClick:L(()=>o(),["prevent"])},{default:a(()=>[m(t(p.$t("craftable-pro","Cancel")),1)]),_:2},1032,["onClick"])]),_:1},8,["open"]))}}),$e={class:"my-4"},he={class:"mb-1 block text-sm font-medium text-gray-700",for:"file"},ke=V({__name:"ImportModalFirstStep",props:{locales:{},processing:{type:Boolean}},emits:["uploadFile","selectLanguage","checkOnlyMissing"],setup(O,{emit:g}){const u=g,i=$(null),v=$(null),l=$(null),p=$(!1),d=o=>{var _;l.value=o.target.files[0],u("uploadFile",o.target.files[0],(_=i==null?void 0:i.value)==null?void 0:_.files[0])};return Y(()=>{u("selectLanguage",v.value)}),Y(()=>{u("checkOnlyMissing",p.value)}),(o,_)=>(c(),C("form",null,[s("div",$e,[s("label",he,[l.value?(c(),C(D,{key:0},[m(t(l.value.name),1)],64)):(c(),C(D,{key:1},[m(t(o.$t("craftable-pro","Choose file")),1)],64))]),s("input",{id:"file",ref_key:"file",ref:i,class:"w-full",name:"importFile",type:"file",onInput:d},null,544)]),r(e(N),{modelValue:v.value,"onUpdate:modelValue":_[0]||(_[0]=F=>v.value=F),options:o.locales,label:o.$t("craftable-pro","Languages to import"),mode:"single",name:""},null,8,["modelValue","options","label"]),r(ue,{modelValue:p.value,"onUpdate:modelValue":_[1]||(_[1]=F=>p.value=F),class:"mt-2",label:o.$t("craftable-pro","Do not override existing translations")},null,8,["modelValue","label"])]))}}),Ce={class:"text-sm font-medium text-gray-700"},Te=V({__name:"ImportModalThirdStep",props:{numberOfSuccessfullyImportedTranslations:{},numberOfSuccessfullyUpdatedTranslations:{}},setup(O){return(g,u)=>(c(),C("p",Ce,t(g.$t("craftable-pro",":count successfully imported",{count:g.numberOfSuccessfullyImportedTranslations.toString()}))+" "+t(g.$t("craftable-pro",":count successfully updated",{count:g.numberOfSuccessfullyUpdatedTranslations.toString()})),1))}}),we={class:"text-sm font-medium text-gray-700"},Oe={class:"border-separate border-spacing-3 border-gray-500"},Fe={key:0},Le={style:{"word-break":"break-all"}},Ie={style:{"word-break":"break-all"}},Ve={style:{"word-break":"break-all"}},Se=["id","onUpdate:modelValue","name"],Me=["for"],Ue={style:{"word-break":"break-all"}},De=["id","onUpdate:modelValue","name"],Be=["for"],Re=V({__name:"ImportModalSecondStep",props:{numberOfFoundTranslations:{},numberOfTranslationsToReview:{},translationsToImport:{},importLanguage:{}},emits:["importedTranslationsChanged"],setup(O,{emit:g}){const u=O,i=g,v=()=>{i("importedTranslationsChanged",u.translationsToImport)};return(l,p)=>(c(),C("form",null,[s("div",we,[s("p",null,t(l.$t("craftable-pro","Found: :found / For review: :toReview",{found:l.numberOfFoundTranslations.toString(),toReview:l.numberOfTranslationsToReview.toString()})),1)]),s("table",Oe,[s("thead",null,[s("tr",null,[s("th",null,t(l.$t("craftable-pro","Group")),1),s("th",null,t(l.$t("craftable-pro","Default")),1),s("th",null,t(l.$t("craftable-pro","Current value")),1),s("th",null,t(l.$t("craftable-pro","Imported value")),1),p[0]||(p[0]=s("th",{style:{display:"none"}},null,-1))])]),s("tbody",null,[(c(!0),C(D,null,K(l.translationsToImport,(d,o)=>(c(),C(D,null,[d.has_conflict?(c(),C("tr",Fe,[s("td",Le,t(d.group),1),s("td",Ie,t(d.default),1),s("td",Ve,[w(s("input",{id:"current-"+o+"0","onUpdate:modelValue":_=>l.translationsToImport[o].checkedCurrent=_,name:"current-"+o,value:!0,class:"import-radio",type:"radio",onChange:v},null,40,Se),[[A,l.translationsToImport[o].checkedCurrent]]),s("label",{for:"current-"+o+"0",class:"form-check-label label-import"},t(l.translationsToImport[o].current_value),9,Me)]),s("td",Ue,[w(s("input",{id:"current-"+o+"1","onUpdate:modelValue":_=>l.translationsToImport[o].checkedCurrent=_,name:"current-"+o,value:!1,class:"import-radio",type:"radio",onChange:v},null,40,De),[[A,l.translationsToImport[o].checkedCurrent]]),s("label",{checked:!0,for:"current-"+o+"1",class:"form-check-label label-import"},t(l.translationsToImport[o][l.importLanguage.toLowerCase()]),9,Be)]),p[1]||(p[1]=s("td",{style:{display:"none"}},null,-1))])):M("",!0)],64))),256))])])]))}}),Pe=V({__name:"ImportModal",props:{locales:{},open:{type:Boolean}},emits:["toggleOpen"],setup(O,{emit:g}){const u=$(!1),i=$(1),v=$(null),l=$(null),p=$(""),d=$(null),o=$(null),_=$(null),F=$(0),n=$([]),y=$(!1),T=b=>{l.value=b,v.value=b},k=b=>{p.value=b},G=b=>{y.value=b},H=E(),J=g,W=()=>{J("toggleOpen")},X=()=>{if(u.value=!0,i.value===1){let b=route("craftable-pro.translations.import"),S=new FormData;S.append("fileImport",l.value??""),S.append("importLanguage",p.value),S.append("onlyMissing",y.value?"1":"0"),q.post(b,S,{headers:{"Content-Type":"multipart/form-data"}}).then(f=>{if(f.data.hasOwnProperty("numberOfImportedTranslations")&&f.data.hasOwnProperty("numberOfUpdatedTranslations"))i.value=3,d.value=f.data.numberOfImportedTranslations,o.value=f.data.numberOfUpdatedTranslations;else{i.value=2,_.value=Object.keys(f.data).length,n.value=f.data;for(let U=0;U<n.value.length;U++)n.value[U].hasOwnProperty("has_conflict")&&n.value[U].has_conflict&&F.value++}},f=>{const U=f.response.data.message||f.response.data;H.error(U)}).finally(()=>{u.value=!1})}else if(i.value===2){for(let f=0;f<n.value.length;f++)n.value[f].hasOwnProperty("checkedCurrent")&&n.value[f].checkedCurrent&&(n.value[f][p.value.toLowerCase()]=n.value[f].current_value);let b="/admin/translations/import/conflicts",S={importLanguage:p.value,resolvedTranslations:n.value};q.post(b,S).then(f=>{i.value=3,d.value=f.data.numberOfImportedTranslations,o.value=f.data.numberOfUpdatedTranslations},f=>{H.error(Z("craftable-pro","An error has occurred."))}).finally(()=>{u.value=!1})}};return(b,S)=>(c(),h(e(j),{open:b.open,onToggleOpen:W,"external-open":!0},{title:a(()=>[m(t(b.$t("craftable-pro","Import translations")),1)]),content:a(()=>[i.value===1?(c(),h(ke,{key:0,locales:b.locales,processing:u.value,onUploadFile:T,onSelectLanguage:k,onCheckOnlyMissing:G},null,8,["locales","processing"])):M("",!0),i.value===2?(c(),h(Re,{key:1,"import-language":p.value,locales:b.locales,"number-of-found-translations":_.value,"number-of-translations-to-review":F.value,processing:u.value,"translations-to-import":n.value},null,8,["import-language","locales","number-of-found-translations","number-of-translations-to-review","processing","translations-to-import"])):M("",!0),i.value===3?(c(),h(Te,{key:2,locales:b.locales,"number-of-successfully-imported-translations":d.value,"number-of-successfully-updated-translations":o.value,processing:u.value},null,8,["locales","number-of-successfully-imported-translations","number-of-successfully-updated-translations","processing"])):M("",!0)]),buttons:a(({setIsOpen:f})=>[i.value!==3?(c(),h(e(I),{key:0,disabled:u.value,onClick:L(X,["prevent"])},{default:a(()=>[m(t(b.$t("craftable-pro","Next step")),1)]),_:1},8,["disabled"])):M("",!0),i.value!==3?(c(),h(e(I),{key:1,variant:"outline",color:"gray",onClick:L(()=>{f()},["prevent"])},{default:a(()=>[m(t(b.$t("craftable-pro","Cancel")),1)]),_:2},1032,["onClick"])):M("",!0),i.value===3?(c(),h(e(I),{key:2,onClick:L(()=>{f(),e(ee).reload(),i.value=1},["prevent"])},{default:a(()=>[m(t(b.$t("craftable-pro","Finish import")),1)]),_:2},1032,["onClick"])):M("",!0)]),_:1},8,["open"]))}}),Ee={class:"flex"},je={class:"py-1"},Ne={class:"max-w-sm overflow-hidden text-ellipsis"},Ge={class:"max-w-sm overflow-hidden text-ellipsis"},He={class:"flex items-center justify-end gap-3"},Ye=V({__name:"Index",props:{data:{},groups:{},locales:{}},setup(O){var _,F;const g=E(),{action:u}=ie(),i=$(!1),v=$(!1),{filtersForm:l,resetFilters:p,activeFiltersCount:d}=be(route("craftable-pro.translations.index"),{group:((F=(_=ae().props)==null?void 0:_.filter)==null?void 0:F.group)??null}),o=()=>{window.location.reload()};return(n,y)=>{const T=te("can");return c(),C(D,null,[r(e(fe),{title:n.$t("craftable-pro","Translations")},{default:a(()=>[s("div",Ee,[w(r(ye,{onToggleOpen:y[0]||(y[0]=k=>i.value=!i.value),open:i.value,locales:n.locales},null,8,["open","locales"]),[[T,"craftable-pro.translation.export"]]),w(r(Pe,{onToggleOpen:y[1]||(y[1]=k=>v.value=!v.value),open:v.value,locales:n.locales},null,8,["open","locales"]),[[T,"craftable-pro.translation.import"]]),r(e(pe),null,{default:a(()=>[w((c(),h(e(I),{onClick:y[2]||(y[2]=()=>{e(u)("post","/admin/translations/publish",{},{onSuccess:()=>{o()}})})},{default:a(()=>[m(t(n.$t("craftable-pro","Publish translations")),1)]),_:1})),[[T,"craftable-pro.translation.publish"]]),w((c(),h(e(ce),{noContentPadding:""},{button:a(()=>[r(e(Q),{icon:e(le),class:"rounded-l-none"},null,8,["icon"])]),content:a(()=>[s("div",je,[w((c(),h(e(P),{onClick:y[3]||(y[3]=()=>{e(u)("post","/admin/translations/rescan"),e(g).warning(n.$t("craftable-pro","Scanning translations..."))})},{default:a(()=>[m(t(n.$t("craftable-pro","Re-scan translations")),1)]),_:1})),[[T,"craftable-pro.translation.rescan"]]),w((c(),h(e(P),{onClick:y[4]||(y[4]=k=>i.value=!0)},{default:a(()=>[m(t(n.$t("craftable-pro","Export")),1)]),_:1})),[[T,"craftable-pro.translation.export"]]),w((c(),h(e(P),{onClick:y[5]||(y[5]=k=>v.value=!0)},{default:a(()=>[m(t(n.$t("craftable-pro","Import")),1)]),_:1})),[[T,"craftable-pro.translation.import"]])])]),_:1})),[[T,["craftable-pro.translation.export","craftable-pro.translation.import","craftable-pro.translation.rescan"],"any"]])]),_:1})])]),_:1},8,["title"]),r(e(me),null,{default:a(()=>[r(e(de),{data:n.data,baseUrl:n.route("craftable-pro.translations.index"),withBulkSelect:!1},{actions:a(()=>[r(e(ge),{activeFiltersCount:e(d),resetFilters:e(p)},{default:a(()=>[r(e(N),{modelValue:e(l).group,"onUpdate:modelValue":y[6]||(y[6]=k=>e(l).group=k),options:n.groups,label:n.$t("craftable-pro","Groups"),mode:"tags",name:"groups"},null,8,["modelValue","options","label"])]),_:1},8,["activeFiltersCount","resetFilters"])]),tableHead:a(()=>[r(e(B),{sortBy:"group"},{default:a(()=>[m(t(n.$t("craftable-pro","Group")),1)]),_:1}),r(e(B),{sortBy:"key"},{default:a(()=>[m(t(n.$t("craftable-pro","Default")),1)]),_:1}),r(e(B),null,{default:a(()=>[m(t(n.$page.props.auth.user.locale),1)]),_:1}),r(e(B),null,{default:a(()=>[m(t(n.$t("craftable-pro","Last update")),1)]),_:1}),r(e(B))]),tableRow:a(({item:k,action:G})=>[r(e(R),null,{default:a(()=>[m(t(k.group),1)]),_:2},1024),r(e(R),null,{default:a(()=>[s("div",Ne,t(k.key),1)]),_:2},1024),r(e(R),null,{default:a(()=>[s("div",Ge,t(k.text[n.$page.props.auth.user.locale]),1)]),_:2},1024),r(e(R),null,{default:a(()=>[m(t(e(oe)(k.updated_at).format("DD.MM.YYYY HH:mm")),1)]),_:2},1024),r(e(R),null,{default:a(()=>[s("div",He,[w(r(ve,{"language-line":k,locales:n.locales},null,8,["language-line","locales"]),[[T,"craftable-pro.translation.edit"]])])]),_:2},1024)]),_:1},8,["data","baseUrl"])]),_:1})],64)}}}),xe=V({__name:"Index",props:{data:{},groups:{},locales:{}},setup(O){return(g,u)=>(c(),h(Ye,ne(se(g.$props)),null,16))}});export{xe as default};
